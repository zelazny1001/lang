import requests
import json
import urllib3

urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning)

URL = "http://localhost:9000/rest/utility?utterance="
UTTERANCE = "test utterance here"

response = requests.get(f"{URL}{UTTERANCE}", verify=False)
response.raise_for_status()
data = response.json()

activity_log = data.get("activityLog", [])

selected_entry = None
for entry in activity_log:
    if entry.get("message") == "Report for component RESPONSE_BUILDER":
        selected_entry = entry
        break

input_data = selected_entry.get("input", {})
intent_data = input_data.get("intent", {})
intent_info = intent_data.get("IntentInfo", [])

first_intent = intent_info[0]
intent = first_intent.get("intent")
score = first_intent.get("score")
features = first_intent.get("features", [])
features_str = "[" + ", ".join(f"'{f}'" for f in formatted_features) + "]"
print(f"Extracted intent: {intent}, Score: {score}, Features: {features_str}")