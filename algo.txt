import pandas as pd

filename = "example.xlsx"
searchString = "token1, token2"

def getMatchingLines(filename, searchString):
    df_input = pd.read_excel(filename, engine="openpyxl")
    tokens = [token.strip().lower() for token in searchString.split(",")]
    matching_lines = []
    seen_utterances = set()
    for idx, row in df_input.iterrows():
        utterance = str(row["Utterance"]).strip("[]").lower()
        if all(token in utterance for token in tokens):
            if utterance not in seen_utterances:
                matching_lines.append((idx, utterance))
                seen_utterances.add(utterance)
    return matching_lines

def main():
    matches = getMatchingLines(filename, searchString)
    print("Matching Utterances:")
    for idx, line in matches:
        print(f"Row {idx}: {line}")

if __name__ == '__main__':
    main()