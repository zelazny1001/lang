import java.io.File;
import java.io.IOException;
import java.nio.file.Files;

public class RestClient {

    private static final String ENDPOINT_URL = "http://whisper.transcribe.endpoint:1234";

    public static String callPostTranscription(String filename) throws IOException {
        RestTemplate restTemplate = new RestTemplate();
        File file = new File(filename);
        byte[] fileBytes = Files.readAllBytes(file.toPath());

        HttpHeaders headers = new HttpHeaders();
        headers.add("Content-Type", "application/octet-stream");

        HttpEntity<byte[]> requestEntity = new HttpEntity<>(fileBytes, headers);

        ResponseEntity<String> response = restTemplate.exchange(ENDPOINT_URL, HttpMethod.POST, requestEntity, String.class);

        if (response.getStatusCode() == HttpStatus.OK) {
            return response.getBody();
        } else {
            throw new IOException("Failed to get transcription: " + response.getStatusCode());
        }
    }

    public static void main(String[] args) {
        try {
            String filename = "path/to/your/file.wav";
            String response = callPostTranscription(filename);
            System.out.println("Transcription: " + response);
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}