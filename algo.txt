playAudioButton.addEventListener("click", () => {
    const selection = window.getSelection();
    const selectedText = selection.toString().trim();

    if (!selectedText) {
        alert("No text selected.");
        return;
    }

    const matchingIndex = cachedTranscriptionData.findIndex(row =>
        row.transcript.toLowerCase().startsWith(selectedText.toLowerCase())
    );

    if (matchingIndex === -1) {
        alert("No matching row found for the selected text.");
        return;
    }

    const matchingRow = cachedTranscriptionData[matchingIndex];

    const startTime = matchingRow.start / 50;
    const endTime = matchingRow.end / 50;

    if (isNaN(startTime) || isNaN(endTime) || startTime >= endTime) {
        alert("Invalid start or end time.");
        return;
    }

    const audioFilePath = `wav/${matchingRow.filename}.wav`;
    const audio = new Audio(audioFilePath);
    audio.currentTime = startTime;
    audio.play();

    setTimeout(() => {
        audio.pause();
    }, (endTime - startTime) * 1000);
});
