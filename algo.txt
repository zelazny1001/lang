import pandas as pd

filename = "example.xlsx"
searchString = "token1, token2"

def getMatchingLines(filename, searchString):
    df_input = pd.read_excel(filename, engine="openpyxl")
    tokens = [token.strip() for token in searchString.split(",")]
    matching_lines = []
    for idx, row in df_input.iterrows():
        utterance = str(row["Utterance"]).strip("[]")
        if all(token in utterance for token in tokens):
            matching_lines.append((idx, utterance))
    return matching_lines

def main():
    matches = getMatchingLines(filename, searchString)
    print("Matching Utterances:")
    for idx, line in matches:
        print(f"Row {idx}: {line}")

if __name__ == '__main__':
    main()