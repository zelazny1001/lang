package analyzer;

import java.io.BufferedWriter;
import java.io.FileInputStream;
import java.io.FileWriter;
import java.io.IOException;
import java.nio.file.Files;
import java.nio.file.Paths;
import java.util.List;
import java.util.stream.Collectors;

public class FFTAnalyzer {

    public static void main(String[] args) throws IOException {
        FFTAnalyzer analyzer = new FFTAnalyzer();
        analyzer.processData();
    }

    public void processData() throws IOException {
        List<TranscriptionWindow> records = readDataFromFile("/tmp/formatted-analysis.txt");

        try (BufferedWriter writer = new BufferedWriter(new FileWriter("/tmp/fft-analysis.txt"))) {
            for (TranscriptionWindow record : records) {
                String filePath = "/asr-data/rod-calls/" + record.getFilename();

                byte[] audioBytes = G711Codec.readAllBytes(new FileInputStream(filePath));
                float[] audioFloats = G711Codec.g711ByteArrayToNormalizedPCM(audioBytes);
                float[] fftResult = FFTProcessor.getFFT(audioFloats);

                // transcription window section
                writer.write(String.format("%s | %d | %d | %s%n", record.getFilename(), record.getStart(), record.getEnd(), record.getTranscript()));

                // Write FFT data values for window
                for (float fftValue : fftResult) {
                    writer.write(fftValue + System.lineSeparator());
                }
            }
        }
    }

    private List<TranscriptionWindow> readDataFromFile(String path) throws IOException {
        return Files.lines(Paths.get(path))
                .map(line -> {
                    String[] parts = line.split("\\|");
                    return new TranscriptionWindow(
                            parts[0].trim(),
                            Integer.parseInt(parts[1].trim()),
                            Integer.parseInt(parts[2].trim()),
                            Integer.parseInt(parts[3].trim()),
                            parts[4].trim(),
                            Integer.parseInt(parts[5].trim()),
                            Integer.parseInt(parts[6].trim()),
                            Integer.parseInt(parts[7].trim())
                    );
                })
                .collect(Collectors.toList());
    }
}

===========================

package analyzer;

public class TranscriptionWindow {
    private final String filename;
    private final int seqNum;
    private final int start;
    private final int end;
    private final String transcript;
    private final int tokens;
    private final int samples;
    private final int samplesPerToken;

    public TranscriptionWindow(String filename, int seqNum, int start, int end, String transcript, int tokens, int samples, int samplesPerToken) {
        this.filename = filename;
        this.seqNum = seqNum;
        this.start = start;
        this.end = end;
        this.transcript = transcript;
        this.tokens = tokens;
        this.samples = samples;
        this.samplesPerToken = samplesPerToken;
    }

    public String getFilename() {
        return filename;
    }

    public int getSeqNum() {
        return seqNum;
    }

    public int getStart() {
        return start;
    }

    public int getEnd() {
        return end;
    }

    public String getTranscript() {
        return transcript;
    }

    public int getTokens() {
        return tokens;
    }

    public int getSamples() {
        return samples;
    }

    public int getSamplesPerToken() {
        return samplesPerToken;
    }
}